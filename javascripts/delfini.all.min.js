/** 
 * Delfini UI
 * -------------------------------
 *
 * ForwardFour Innovations: http://forwardfour.com/
 * Delfini UI: http://delfiniui.com/
 * 
 * LICENSE
 * 
 * By viewing, using, or actively developing this framework in any way, you are
 * henceforth bound the license agreement, and all of its changes, set forth by
 * ForwardFour Innovations or the Delfini UI Group. The license can be found,
 * in its entirety, at this address: http://delfiniui.com/license.
 * 
 * Copyright (c) 2012 and Onwards, ForwardFour Innovations & The Delfini UI Group
 * http://delfiniui.com/license [Proprietary]
 *
 *
 *
 * Included in this file:
 *  - delfini.dialog
 *  - delfini.menu
 *  - delfini.textinput
*/

(function(a){a(document).ready(function(){a.fn.delfini_dialog=function(c){var d=a(this);if(c&&c=="close"){d.animate({top:"-900px"},function(){d.remove()});d.trigger("dialogClosed");return true}d.animate({top:"0px"},function(){d.trigger("dialogOpened")})};a("ul.dropdown").wrap('<div class="dropdownWrapper" />').after(function(){var c=a(this);a(this).trigger("dropdownReady");return'<input name="'+c.attr("data-name")+'" type="hidden" value="'+c.children("li.selected").text()+'"/>'});a("body").delegate("ul.dropdown","click",function(){var c=a(this);var f=c.offset().left;var e=c.offset().top;var d=a(document).height();c.addClass("open");if(e+c.height()>d){e-=(e+c.height()+20)-d}c.css({left:f+"px",position:"absolute",top:e+"px"});c.trigger("menuOpened")});a(document).click(function(c){if(!a(c.target).is("ul.dropdown")&&!a(c.target).parents().is("ul.dropdown")){a("ul.dropdown").removeClass("open").removeAttr("style")}});a("body").delegate("ul.dropdown li","click",function(f){var d=a(this);var g=d.parent();var c=true;if(g.hasClass("open")){if(d.parent().children("li.selected").is(d)){c=false}d.addClass("reservedItemCurrentlySelcted").siblings("li.selected").removeClass("selected").siblings("li.reservedItemCurrentlySelcted").removeClass("reservedItemCurrentlySelcted").addClass("selected");g.removeClass("open").removeAttr("style");f.stopPropagation();if(d.attr("data-value")&&d.attr("data-value")!=undefined&&d.attr("data-value")!=""){g.siblings("input").val(d.attr("data-value"))}else{g.siblings("input").val(d.text())}currentMenu.trigger("menuItemSelected");if(c){currentMenu.trigger("newMenuItemSelected")}}});var b=a("input:text:not(.noMod), input:password:not(.noMod), input[type=email]:not(.noMod), input[type=search]:not(.noMod)");b.wrap('<div class="inputWrapper" />').after(function(){var c=a(this);c.trigger("textInputReady");if(c.attr("type").toLowerCase()=="password"){return c.hasClass("noIcon")?"<span />":'<span class="passwordPeak" title="Press and hold to view this password" />'}else{return c.hasClass("noIcon")?"<span />":'<span class="inputClear" title="Click to clear contents" />'}});b.siblings("span").mousedown(function(){var d=a(this);var c=d.siblings("input");if(c.attr("type").toLowerCase()=="password"){var e=c.attr("value");c.hide();a('<input class="passwordViewer" type="text" />').attr("value",e).insertAfter(d);c.trigger("passwordVisible")}else{c.val("");c.trigger("inputCleared")}});b.siblings("span").bind("mouseup mouseout",function(){var d=a(this);var c=d.siblings("input");if(c.attr("type").toLowerCase()=="password"){d.siblings("input.passwordViewer").remove();c.show();c.trigger("passwordHidden")}})})})(jQuery);