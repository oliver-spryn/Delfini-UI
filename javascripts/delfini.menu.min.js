/*
 * Delfini UI - Drop Down Menu
 * -------------------------------
 *
 * ForwardFour Innovations: http://forwardfour.com/
 * Delfini UI: http://delfiniui.com/
 * 
 * LICENSE
 * 
 * By viewing, using, or actively developing this framework in any way, you are
 * henceforth bound the license agreement, and all of its changes, set forth by
 * ForwardFour Innovations or the Delfini UI Group. The license can be found,
 * in its entirety, at this address: http://delfiniui.com/license.
 * 
 * Copyright (c) 2012 and Onwards, ForwardFour Innovations & The Delfini UI Group
 * http://delfiniui.com/license [Proprietary]
 *
 *
 *
 * Example usage:
 *
 * <ul class="dropdown" data-name="menu">      The "dropdown" class will activate this UI widget for a given
 * <li>Option</li>                             unordered list
 * <li>Option</li>                             The "data-name" attribute will be the name of the HTML element
 * <li class="selected">Option</li>            when the data is submitted in a <form>
 * <li>A longer option</li>                    The "selected" class shows the currently selected option
 * </ul>
 *
 *
 *
 * Events dispatched:
 *  - dropdownReady                            The unordered list has been properly modified and is ready for use
 *  - menuOpened                               The user has opened the menu
 *  - menuClosed [FORTH COMMING]               The user has closed the menu
 *  - menuItemSelected                         A menu item has been selected
 *  - newMenuItemSelected                      A different menu item than the previously selected item was chosen
*/

(function(a){a(document).ready(function(){var c=a("ul.dropdown");var b=a("ul.dropdown li");c.wrap('<div class="dropdownWrapper" />').after(function(){var d=a(this);a(this).trigger("dropdownReady");return'<input name="'+d.attr("data-name")+'" type="hidden" value="'+d.children("li.selected").text()+'"/>'});c.click(function(){var d=a(this);var f=d.offset().left;var e=d.offset().top;var g=a(window).height();d.addClass("open");if(e+d.height()>g){e-=(e+d.height()+20)-g}d.css({left:f+"px",position:"absolute",top:e+"px"});d.trigger("menuOpened")});a(document).click(function(d){if(!a(d.target).is("ul.dropdown")&&!a(d.target).parents().is("ul.dropdown")){c.removeClass("open").removeAttr("style")}});b.click(function(g){var f=a(this);var h=f.parent();var d=true;if(h.hasClass("open")){if(f.parent().children("li.selected").is(f)){d=false}f.addClass("reservedItemCurrentlySelcted").siblings("li.selected").removeClass("selected").siblings("li.reservedItemCurrentlySelcted").removeClass("reservedItemCurrentlySelcted").addClass("selected");h.removeClass("open").removeAttr("style");g.stopPropagation();h.siblings("input").val(f.text());currentMenu.trigger("menuItemSelected");if(d){currentMenu.trigger("newMenuItemSelected")}}})})})(jQuery);